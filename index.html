<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIBM Placement Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { -webkit-user-select: none; user-select: none; overflow: hidden; }
        .blurred { filter: blur(30px); pointer-events: none; transition: 0.3s; }
        .sidebar-item.active { border-left: 5px solid #2563eb; background-color: #f0f7ff; }
        #protected-ui { display: none; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="bg-slate-50 font-sans" oncontextmenu="return false;">

    <div id="login-screen" class="min-h-screen flex items-center justify-center bg-slate-900 p-4">
        <div class="bg-white p-10 rounded-3xl shadow-2xl w-full max-w-md text-center">
            <div class="text-blue-600 font-black text-4xl mb-2 italic">PIBM</div>
            <h1 class="text-xl font-bold text-slate-800 mb-8 uppercase tracking-widest">KnowYourPlacements</h1>
            <button id="btn-login" class="flex items-center justify-center gap-3 w-full bg-slate-900 text-white py-4 rounded-xl hover:bg-black transition font-bold shadow-lg">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="22">
                Verify Student ID
            </button>
            <p class="mt-6 text-xs text-slate-400 font-medium">Restricted to @pibm.in accounts only</p>
        </div>
    </div>

    <div id="protected-ui" class="h-screen flex flex-col">
        <header class="bg-white border-b px-8 py-5 flex justify-between items-center shadow-sm z-10">
            <div class="flex items-center gap-3">
                <span class="font-black text-2xl text-slate-900 tracking-tighter italic">PIBM</span>
                <div class="h-6 w-[1px] bg-slate-200"></div>
                <span class="text-slate-500 font-bold text-sm uppercase tracking-widest">Floated Companies for the year 2k26</span>
            </div>
            <div class="flex items-center gap-6">
                <span id="user-display" class="hidden md:block text-sm font-bold text-slate-400 italic"></span>
                <button id="btn-logout" class="bg-rose-50 text-rose-600 px-5 py-2 rounded-full text-xs font-black uppercase hover:bg-rose-100 transition tracking-widest">Logout</button>
            </div>
        </header>

        <div class="flex flex-1 overflow-hidden">
            <nav class="w-1/3 lg:w-1/4 bg-white border-r flex flex-col">
                <div class="p-6 border-b bg-slate-50/50">
                    <input type="text" id="search-bar" placeholder="Search Company, Role or Dept..." 
                           class="w-full px-4 py-3 bg-white border border-slate-200 rounded-2xl text-sm focus:outline-none focus:ring-4 focus:ring-blue-100 transition shadow-sm font-medium">
                </div>
                <div id="company-list" class="flex-1 overflow-y-auto p-4 space-y-3">
                    </div>
            </nav>

            <main class="flex-1 bg-white overflow-y-auto" id="job-display">
                <div class="h-full flex flex-col items-center justify-center text-slate-300 space-y-4">
                    <svg class="w-16 h-16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
</svg>
                    <p class="font-bold uppercase tracking-widest text-sm">Select company to view details</p>
                </div>
                <footer class="mt-auto border-t py-4 px-6 bg-slate-50 text-center md:text-left">
    <div class="flex flex-col md:flex-row justify-between items-center gap-2">
        <p class="text-xs font-bold text-slate-400 uppercase tracking-widest">
            Developed by 
            <a href="https://linkedin.com/analystnikhil" target="_blank" class="text-blue-600 hover:underline">lazynikh</a>
        </p>
        <div class="flex items-center gap-2">
            <img src="https://www.gstatic.com/images/branding/googlelogo/svg/googlelogo_clr_74x24dp.svg" alt="Google" class="h-3 opacity-70">
            <span class="text-[10px] font-black text-slate-500 uppercase tracking-tighter">Google Campus Ambassador</span>
        </div>
    </div>
</footer>
            </main>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // --- PASTE YOUR FIREBASE CONFIG HERE ---
        const firebaseConfig = {
            apiKey: "AIzaSyD69PnIcAaNC-MVHAR9iaWwNvrxyMLfCys",
            authDomain: "know-your-placement.firebaseapp.com",
            projectId: "know-your-placement",
            storageBucket: "know-your-placement.firebasestorage.app",
            messagingSenderId: "603215423128",
            appId: "1:603215423128:web:96638dca43ae072b98d2ed"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();

        let jobsCache = [];

        // Auth
        document.getElementById('btn-login').onclick = () => signInWithPopup(auth, provider);
        document.getElementById('btn-logout').onclick = () => signOut(auth);

        onAuthStateChanged(auth, (user) => {
            if (user && user.email.endsWith('@pibm.in')) {
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('protected-ui').style.display = 'flex';
                document.getElementById('user-display').innerText = user.email;
                startSync();
            } else {
                if (user) { alert("Access Denied. Use @pibm.in ID"); signOut(auth); }
                document.getElementById('login-screen').classList.remove('hidden');
                document.getElementById('protected-ui').style.display = 'none';
            }
        });

        // Sync Jobs
        function startSync() {
            onSnapshot(collection(db, "placements"), (snap) => {
                jobsCache = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderList(jobsCache);
            });
        }

        // Render Sidebar
        function renderList(jobs) {
            const list = document.getElementById('company-list');
            list.innerHTML = '';
            jobs.forEach(job => {
                const card = document.createElement('div');
                card.className = "sidebar-item p-5 rounded-2xl border border-slate-100 cursor-pointer hover:shadow-md transition bg-white";
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <span class="font-black text-slate-800 tracking-tight">${job.company}</span>
                        <span class="text-[9px] font-black bg-blue-50 text-blue-600 px-2 py-1 rounded-lg uppercase tracking-wider border border-blue-100">${job.department || 'N/A'}</span>
                    </div>
                    <p class="text-xs font-bold text-slate-400 uppercase tracking-tighter">${job.role}</p>
                `;
                card.onclick = () => {
                    document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
                    card.classList.add('active');
                    showJD(job);
                };
                list.appendChild(card);
            });
        }

        // Search
        document.getElementById('search-bar').oninput = (e) => {
            const val = e.target.value.toLowerCase();
            const filtered = jobsCache.filter(j => 
                j.company.toLowerCase().includes(val) || 
                j.role.toLowerCase().includes(val) || 
                (j.department && j.department.toLowerCase().includes(val))
            );
            renderList(filtered);
        };

        function showJD(job) {
            document.getElementById('job-display').innerHTML = `
                <div class="p-10 lg:p-16 max-w-4xl animate-in fade-in duration-500">
                    <div class="flex items-center gap-2 mb-4">
                        <span class="bg-blue-600 text-white px-3 py-1 rounded text-[10px] font-black uppercase tracking-widest">${job.department}</span>
                        <span class="text-slate-300">â€¢</span>
                        <span class="text-slate-500 font-bold text-sm uppercase tracking-widest">${job.company}</span>
                    </div>
                    <h2 class="text-5xl font-black text-slate-900 tracking-tighter mb-10 leading-none">${job.role}</h2>
                    <div class="prose prose-slate max-w-none">
                        <h4 class="text-xs font-black text-slate-400 uppercase tracking-[0.2em] mb-4">Detailed Job Description</h4>
                        <div class="text-slate-700 text-lg leading-relaxed whitespace-pre-wrap font-medium">${job.details}</div>
                    </div>
                </div>
            `;
        }

        // Anti-Screenshot
        window.onblur = () => document.body.classList.add('blurred');
        window.onfocus = () => document.body.classList.remove('blurred');
    </script>
</body>

</html>



